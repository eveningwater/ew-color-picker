!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ewColorPicker=t()}(this,(function(){"use strict";const e=Object.create(null),t=Object.prototype.toString,o=Object.prototype.hasOwnProperty;["Number","String","Function","Undefined","Boolean"].forEach(t=>e["is"+t]=e=>typeof e===t.toLowerCase()),e.addMethod=(e,t,o)=>(e.prototype[t]=o,e),["Object","Array","RegExp"].forEach(o=>e["isDeep"+o]=e=>t.call(e).slice(8,-1).toLowerCase()===o.toLowerCase()),e.isShallowObject=t=>"object"==typeof t&&!e.isNull(t),e.ewObjToArray=t=>e.isShallowObject(t)?Array.prototype.slice.call(t):t,e.isNull=e=>null===e,e.ewAssign=function(t){if(e.isNull(t))return;const o=Object(t);for(let e=1,t=arguments.length;e<t;e+=1){const t=arguments[e];if(t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e])}return o},e.addClass=(e,t)=>e.classList.add(t),e.removeClass=(e,t)=>e.classList.remove(t),e.hasClass=(t,o)=>{let i=e=>new RegExp(" "+t.className+" ").test(" "+e+" ");return e.isDeepArray(o)?o.some(e=>i(e)):i(o)},e.setCss=(e,t,o)=>e.style.setProperty(t,o),e.setSomeCss=(t,o=[])=>{o.length&&o.forEach(o=>e.setCss(t,o.prop,o.value))},e.isDom=t=>e.isShallowObject(HTMLElement)?t instanceof HTMLElement:t&&e.isShallowObject(t)&&1===t.nodeType&&e.isString(t.nodeName)||t instanceof HTMLCollection||t instanceof NodeList,e.ewError=e=>console.error("[ewColorPicker warn]\n"+new Error(e)),e.ewWarn=e=>console.warn("[ewColorPicker warn]\n"+e),e.deepCloneObjByJSON=e=>JSON.parse(JSON.stringify(e)),e.deepCloneObjByRecursion=function t(o){if(!e.isShallowObject(o))return;let i=e.isDeepArray(o)?[]:{};for(let n in o)i[n]=e.isShallowObject(o[n])?t(o[n]):o[n];return i},e.getCss=(e,t)=>window.getComputedStyle(e,null)[t],e.$=(e,t=document)=>t.querySelector(e),e.$$=(e,t=document)=>t.querySelectorAll(e),e.on=(e,t,o,i=!1)=>{e&&t&&o&&e.addEventListener(t,o,i)},e.off=(e,t,o,i=!1)=>{e&&t&&o&&e.removeEventListener(t,o,i)},e.getRect=e=>e.getBoundingClientRect(),e.baseClickOutSide=(t,o=!0,i)=>{const n=r=>{const s=e.getRect(t),a=r.target;if(!a)return;const l=e.getRect(a);l.x>=s.x&&l.y>=s.y&&l.width<=s.width&&l.height<=s.height||(e.isFunction(i)&&i(),o&&setTimeout(()=>{e.off(document,e.eventType[0],n)},0))};e.on(document,e.eventType[0],n)},e.clickOutSide=(t,o,i)=>{const n=r=>{const s=e.getRect(t.$Dom.picker);let a=null;o.hasBox&&(a=e.getRect(t.$Dom.box));const l=r.target;if(!l)return;const c=e.getRect(l);if(o.hasBox){if(c.x>=s.x&&c.y>=s.y&&c.width<=s.width)return;if(c.x>=a.x&&c.y>=a.y&&c.width<=a.width&&c.height<=a.height)return;i()}else{if(c.x>=s.x&&c.y>=s.y&&c.width<=s.width&&c.height<=s.height)return;i()}setTimeout(()=>{e.off(document,e.eventType[0],n),e.on(document,e.eventType[0],n)},0)};e.on(document,e.eventType[0],n)},e.createUUID=()=>(1e7*Math.random()).toString(16).substr(0,4)+"-"+(new Date).getTime()+"-"+Math.random().toString().substr(2,5),e.removeAllSpace=e=>e.replace(/\s+/g,""),e.isJQDom=e=>void 0!==window.jQuery&&e instanceof jQuery,e.isPromise=t=>!e.isUndefined(t)&&!e.isNull(t)&&e.isFunction(t.then)&&e.isFunction(t.catch);const i=function(...n){const r=[];for(let s=0,a=n.length;s<a;s++){const a=n[s];if(a)if(e.isString(a)||e.isNumber(a))r.push(a);else if(e.isDeepArray(a)){if(a.length){const e=i.apply(null,a);e&&r.push(e)}}else if(a.toString===t)for(let e in a)o.call(a,e)&&a[e]&&r.push(e);else r.push(a.toString())}return r.join(" ")};e.classnames=i,e.eventType=navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];const n=["html","head","meta","title","link","style","script"],r={DOM_OBJECT_ERROR:"can not find the element by el property,make sure to pass a correct value!",DOM_ERROR:"can not find the element,make sure to pass a correct param!",CONFIG_SIZE_ERROR:"the value must be a string which is one of the normal,medium,small,mini,or must be an object and need to contain width or height property!",DOM_NOT_ERROR:"Do not pass these elements: "+n.join(",")+" as a param,pass the correct element such as div!",PREDEFINE_COLOR_ERROR:'"predefineColor" is a array that is need to contain color value!',CONSTRUCTOR_ERROR:"ewColorPicker is a constructor and should be called with the new keyword!",DEFAULT_COLOR_ERROR:'the "defaultColor" is not an invalid color,make sure to use the correct color!',UPDATE_PARAM_COLOR_ERROR:"the param is not a invalid color,make sure to use the correct color!",UPDATE_PARAM_COLOR_WARN:"the color picker is hided,make sure showing it and then updating the color!",COLOR_MODE_ERROR:"To turn on the mode for changing the color, the 'alpha' property and the 'hue' property should be set to true!"},s={};function a(){this.timers=[],this.args=[],this.isTimerRun=!1}a.makeTimerManage=function(e){const t=e.TimerManage;t&&t.constructor===a||(e.TimerManage=new a)};function l(e){const t=e.TimerManage;t&&t.constructor===a&&t.next()}function c(t,o,i){let n="";if(t.indexOf("slide")>-1)n="height"+i+" ms",e.setCss(o,"overflow","hidden"),function(){const n=t.toLowerCase().indexOf("down")>-1;n&&e.setCss(o,"display","block");const r=function(t,o){let i=e.getCss(t,o);return e.removeAllSpace(i).length?parseInt(i):Number(i)},s=[].reduce.call(o.children,(e,t)=>e+=t.offsetHeight+r(t,"margin-top")+r(t,"margin-bottom"),0);let a=Math.max(o.offsetHeight,s+10),c=n?0:a,h=a/(i/10);n&&e.setCss(o,"height","0px");let p=null,u=()=>{c=n?c+h:c-h,e.setCss(o,"height",c+"px"),c>=a||c<=0?(clearTimeout(p),e.setCss(o,"height",a+"px"),l(o)):p=setTimeout(u,10),!n&&c<=0&&e.setSomeCss(o,[{prop:"display",value:"none"},{prop:"height",value:0}])};u()}();else{if(!(t.indexOf("fade")>-1))return n="display"+i+" ms",function(){const n=t.indexOf("show")>-1;return new Promise((t,r)=>{setTimeout(()=>{e.setCss(o,"display",n?"block":"none"),t()},Math.floor(i/100))})}();n="opacity"+i+" ms",function(){const n=t.toLowerCase().indexOf("in")>-1;let r=null,s=100/(i/10),a=n?0:100;e.setSomeCss(o,[{prop:"display",value:n?"none":"block"},{prop:"opacity",value:n?0:1}]);let c=function(){a=n?a+s:a-s,"none"===o.style.display&&n&&e.setCss(o,"display","block"),e.setCss(o,"opacity",(a/100).toFixed(2)),a>=100||a<=0?(r&&clearTimeout(r),l(o),a<=0&&e.setCss(o,"display","none"),e.setCss(o,"opacity",a>=100?1:0)):r=setTimeout(c,10)};c()}()}e.setCss(o,"transition",n)}[{method:"add",func:function(e,t){this.timers.push(e),this.args.push(t),this.timerRun()}},{method:"timerRun",func:function(){if(!this.isTimerRun){let e=this.timers.shift(),t=this.args.shift();e&&t&&(this.isTimerRun=!0,e(t[0],t[1]))}}},{method:"next",func:function(){this.isTimerRun=!1,this.timerRun()}}].forEach(t=>e.addMethod(a,t.method,t.func)),["slideUp","slideDown","fadeIn","fadeOut"].forEach(e=>{s[e]=function(t){a.makeTimerManage(t),t.TimerManage.add((function(t,o){return c(e,t,o)}),arguments)}}),["show","hide"].forEach(e=>{s[e]=function(t,o){return c(e,t,o)}});const h=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,p=/[rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}/g,u=/^[rR][gG][Bb][Aa][\(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){3}[\\s]*(1|1.0|0|0?.[0-9]{1,2})[\\s]*[\)]{1}$/,d=/^[hH][Ss][Ll][\(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*)[\)]$/,f=/^[hH][Ss][Ll][Aa][\(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,){2}([\\s]*(1|1.0|0|0?.[0-9]{1,2})[\\s]*)[\)]$/;function m(t,o){let i=o||1,n=t.toLowerCase(),r=t.length,s=[];if(t&&h.test(n)){if(4===r){let e="#";for(let t=1;t<r;t++){let o=n.slice(t,t+1);e+=o.concat(o)}n=e}for(let e=1,t=n.length;e<t;e+=2)s.push(parseInt("0X"+n.slice(e,e+2),16));return e.removeAllSpace("rgba("+s.join(",")+","+i+")")}return e.removeAllSpace(n)}function g(t){const o={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};if(/rgba?/.test(t)){let i=t.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),n="";return i.map((e,t)=>{t<=2&&(n+=function(e){e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return""+(o[t]||t)+(o[i]||i)}(e))}),e.removeAllSpace("#"+n)}}function b(t,o){let i,n,r,s=t.a,a=t.h,l=255*t.s/100,c=255*t.v/100;if(0===l)i=n=r=c;else{let e=c,t=(255-l)*c/255,o=a%60*(e-t)/60;360===a?(i=e,n=r=0):a<60?(i=e,n=t+o,r=t):a<120?(i=e-o,n=e,r=t):a<180?(i=t,n=e,r=t+o):a<240?(i=t,n=e-o,r=e):a<300?(i=t+o,n=t,r=e):a<360?(i=e,n=t,r=e-o):i=n=r=0}return(o>=0||o<=1)&&(s=o),e.removeAllSpace("rgba("+Math.ceil(i)+","+Math.ceil(n)+","+Math.ceil(r)+","+s+")")}function C(t){let o,i,n,r=t.h,s=t.s/100,a=t.l/100,l=t.a;if(0===s)o=i=n=a;else{let e=(e,t,o)=>(o>1&&(o-=1),o<0&&(o+=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+6*(t-e)*(2/3-o):e),t=a>=.5?a+s-a*s:a*(1+s),l=2*a-t,c=r/360;o=e(l,t,c+1/3),i=e(l,t,c),n=e(l,t,c-1/3)}return e.removeAllSpace(`rgba(${Math.ceil(255*o)},${Math.ceil(255*i)},${Math.ceil(255*n)},${l})`)}function v(t){const o=t.slice(t.indexOf("(")+1,t.lastIndexOf(")")).split(",");let i,n,r=o.length<4?1:Number(o[3]),s=parseInt(o[0])/255,a=parseInt(o[1])/255,l=parseInt(o[2])/255,c=Math.max(s,a,l),h=Math.min(s,a,l),p=(c+h)/2;if(c===h)i=n=0;else{const e=c-h;switch(n=p>.5?e/(2-c-h):e/(c+h),c){case s:i=(a-l)/e+(a>=l?0:6);break;case a:i=(l-s)/e+2;break;case l:i=(s-a)/e+4}}return{colorStr:e.removeAllSpace("hsla("+Math.ceil(60*i)+","+Math.ceil(100*n)+"%,"+Math.ceil(100*p)+"%,"+r+")"),colorObj:{h:i,s:n,l:p,a:r}}}function w(e){const t=e.slice(e.indexOf("(")+1,e.lastIndexOf(")")).split(",");let o,i,n,r=t.length<4?1:Number(t[3]),s=parseInt(t[0])/255,a=parseInt(t[1])/255,l=parseInt(t[2])/255,c=Math.min(s,a,l),h=n=Math.max(s,a,l),p=h-c;if(i=0===h?0:1-c/h,h===c)o=0;else{switch(h){case s:o=(a-l)/p+(a<l?6:0);break;case a:o=2+(l-s)/p;break;case l:o=4+(s-a)/p}o*=60}return i*=100,n*=100,{h:o,s:i,v:n,a:r}}function k(t){const o=document.createElement("div");e.setCss(o,"background-color",t),document.body.appendChild(o);const i=e.getCss(o,"background-color");document.body.removeChild(o);let n=i.match(/,/g)&&i.match(/,/g).length>2?i:i.slice(0,2)+"ba"+i.slice(3,i.length-1)+", 1)";return e.removeAllSpace(n)}function D(e){let t="transparent"===e;return h.test(e)||p.test(e)||u.test(e)||d.test(e)||f.test(e)||"rgba(0,0,0,0)"!==k(e)&&!t||t}function x(e){return p.test(e)||u.test(e)||d.test(e)||f.test(e)}var $=Object.freeze({__proto__:null,colorRegExp:h,colorRegRGB:p,colorRegRGBA:u,colorRegHSL:d,colorRegHSLA:f,colorHexToRgba:m,colorRgbaToHex:g,colorHsvaToRgba:b,colorHslaToRgba:C,colorRgbaToHsla:v,colorRgbaToHsva:w,colorToRgba:k,isValidColor:D,isAlphaColor:x});function O(e,t,o){let i=e.colorMode.length;"up"===t?e.modeCount+=1:e.modeCount-=1,e.modeCount>i-1&&(e.modeCount=0),e.modeCount<0&&(e.modeCount=i-1),e.currentMode=e.colorMode[e.modeCount],o()}function R(t,o){return e.setCss(t,"background",o)}function y(t,o){const i=b(t.hsvaColor);let n=o||t.config.alpha?i:g(i);t.config.openChangeColorMode&&(n=function(e,t){let o=null;switch(e.currentMode){case"hex":o=g(t);break;case"rgba":o=k(t);break;case"hsla":o=v(t).colorStr;break;default:o=t}return e.$Dom.modeTitle.innerHTML=e.currentMode,o}(t,i)),t.config.hasInput&&(t.$Dom.pickerInput.value=n,t.prevInputValue=n),function(t){if(!t.$Dom.alphaBarBg)return;let o=t.isAlphaHorizontal?"to right":"to top";e.setCss(t.$Dom.alphaBarBg,"background","linear-gradient("+o+","+b(t.hsvaColor,0)+" 0%,"+b(t.hsvaColor,1)+" 100%)")}(t),t.config.hasBox&&t.config.boxBgColor&&t.boxChange&&R(t.$Dom.box,n),e.isFunction(t.config.changeColor)&&t.config.changeColor(n)}function _(t){const o=e.deepCloneObjByRecursion(t);return o.s=o.v=100,o}function T(t,o,i,n){t.boxChange=n,y(t),t.config.hasInput&&(t.prevInputValue=t.$Dom.pickerInput.value);let r=parseInt(t.hsvaColor.s*o/100),s=parseInt(i-t.hsvaColor.v*i/100);[{el:t.$Dom.pickerCursor,prop:"left",value:r+4+"px"},{el:t.$Dom.pickerCursor,prop:"top",value:s+4+"px"},{el:t.$Dom.pickerPanel,prop:"background",value:g(b(_(t.hsvaColor)))}].forEach(t=>e.setCss(t.el,t.prop,t.value)),E(t)}function E(t){t.config.hue&&A(t.isHueHorizontal,t.$Dom.hueBar,(o,i)=>{e.setCss(t.$Dom.hueThumb,i,parseInt(t.hsvaColor.h*o/360)+"px")}),t.config.alpha&&A(t.isAlphaHorizontal,t.$Dom.alphaBar,(o,i)=>{e.setCss(t.$Dom.alphaBarThumb,i,(t.isAlphaHorizontal?t.hsvaColor.a*o:o-t.hsvaColor.a*o)+"px")})}function A(e,t,o){o(e?t.offsetWidth:t.offsetHeight,e?"left":"top")}function M(e,t){t.defaultColor?e.hsvaColor=u.test(t.defaultColor)?w(t.defaultColor):w(k(t.defaultColor)):e.hsvaColor={h:0,s:100,v:100,a:1}}function S(e,t,o=200){o=o>1e4?1e4:o;let i="";switch(e){case"height":i="slideDown";break;case"opacity":i="fadeIn";break;default:i="show"}return s[i](t,o)}function I(e,t,o=200){o=o>1e4?1e4:o;let i="";switch(e){case"height":i="slideUp";break;case"opacity":i="fadeOut";break;default:i="hide"}return s[i](t,o)}function H(e){return e.config.pickerAnimation}function P(t,o,i){o._privateConfig.pickerFlag=!o._privateConfig.pickerFlag;const n=function(e){const t=e.config.pickerAnimationTime;return e._privateConfig.pickerFlag?S(H(e),e.$Dom.picker,t):I(H(e),e.$Dom.picker,t)}(o);e.isFunction(o.config.togglePicker)&&o.config.togglePicker(t,o._privateConfig.pickerFlag,o),e.isPromise(n)?n.then(()=>{z(o,i)}):z(o,i)}function z(t,o){e.isFunction(o)&&o(t._privateConfig.pickerFlag)}const B=function(){},L={hue:!0,alpha:!1,size:"normal",predefineColor:[],disabled:!1,defaultColor:"",pickerAnimation:"default",pickerAnimationTime:200,sure:B,clear:B,togglePicker:B,isLog:!0,changeColor:B,hasBox:!0,isClickOutside:!0,hasClear:!0,hasSure:!0,hasInput:!0,boxDisabled:!1,openChangeColorMode:!1,boxBgColor:!1,hueDirection:"vertical",alphaDirection:"vertical",lang:"zh",userDefineText:!1};var j={clearText:"清空",sureText:"确定"},F={clearText:"clear",sureText:"sure"};function N(e){e.hueDirection="horizontal"===e.hueDirection?e.hueDirection:"vertical",e.alphaDirection="horizontal"===e.alphaDirection?e.alphaDirection:"vertical"}function U(t){let o="en"===t.lang?F:j;return t=t.userDefineText?e.ewAssign(t,o):e.ewAssign(o,t),Promise.resolve(t)}function W(t){const o={...L};let i,n,s=null;return e.isString(t)||e.isDom(t)||e.isJQDom(t)?(s=o,i=e.isJQDom(t)?t.get(0):t,n=r.DOM_ERROR):e.isDeepObject(t)&&(e.isString(t.el)||e.isDom(t.el)||e.isJQDom(t.el))?(N(t),s=e.ewAssign(o,t),i=e.isJQDom(t.el)?t.el.get(0):t.el,n=r.DOM_OBJECT_ERROR):(i="body",e.isDeepObject(t)?(N(t),s=e.ewAssign(o,t),n=r.DOM_OBJECT_ERROR):(s=o,n=r.DOM_ERROR)),U(s),s.isLog&&console.log("%c ew-color-picker@2.0.0%c 联系QQ：854806732 %c 联系微信：eveningwater %c github:https://github.com/eveningwater/ew-color-picker %c ","background:#0ca6dc ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),-1===["height","opacity"].indexOf(s.pickerAnimation)&&(s.pickerAnimation="default"),{element:i,config:s,error:n}}let J=null;function Q(e,t){let o=W(t);o&&(e.config=o.config,J=o.error,e._privateConfig={boxSize:{b_width:null,b_height:null},pickerFlag:!1,colorValue:""},e.beforeInit(o.element,o.config,J))}function V(t,o,i){const n=this;e.on(t,e.eventType[0],()=>{const r=r=>{var s;r.preventDefault(),s=r,n.moveX=e.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientX:s.clientX,n.moveY=e.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientY:s.clientY,i?o(n,n.moveX,n.moveY):o(n,t,n.moveX,n.moveY)},s=()=>{e.off(document,e.eventType[1],r),e.off(document,e.eventType[2],s)};e.on(document,e.eventType[1],r),e.on(document,e.eventType[2],s)})}const X=Object.create(null);[$,e,{bindEvent:V}].forEach(t=>{Object.keys(t).forEach(o=>{e.isFunction(t[o])&&"clickOutSide"!==o&&(X[o]=t[o])})});var G={createColorPicker:function(e){const t=function(){Q(this,e)};return(t.prototype=Object.create(this.prototype)).constructor=t,t.Super=this,new t},getDefaultConfig:function(){return L},destroy:function(e){let t=e=>{e instanceof ewColorPicker&&e.destroy()};if(X.isDeepArray(e)){let o=e.length;for(;o--;)t(e[o])}else t(e)},util:X};function Y(t,o){let i,n;if(e.isString(o.size))switch(o.size){case"normal":i=n="40px";break;case"medium":i=n="36px";break;case"small":i=n="32px";break;case"mini":i=n="28px";break;default:i=n="40px"}else{if(!e.isDeepObject(o.size))return e.ewError(r.CONFIG_SIZE_ERROR);i=o.size.width&&(e.isNumber(o.size.width)||e.isString(o.size.width))?(parseInt(o.size.width)<=25?25:parseInt(o.size.width))+"px":"40px",n=o.size.height&&(e.isNumber(o.size.height)||e.isString(o.size.height))?(parseInt(o.size.height)<=25?25:parseInt(o.size.height))+"px":"40px"}return t._privateConfig.boxSize.b_width=i,t._privateConfig.boxSize.b_height=n,Promise.resolve(t._privateConfig.boxSize)}function q(t,o){e.clickOutSide(t,o,()=>{o.isClickOutside&&t._privateConfig.pickerFlag&&(t._privateConfig.pickerFlag=!1,I(H({config:o}),t.$Dom.picker,o.pickerAnimationTime),o.hasBox&&o.boxBgColor&&R(t.$Dom.box,o.defaultColor))})}function Z(t,o,i){let n=t.firstElementChild;return e.hasClass(n,"ew-color-picker-container")||(n=t),i?e.$$("."+o):e.$("."+o)}function K(t,o,i,n){const r=t?"x":"y",s=t?"left":"top",a=t?o.offsetWidth:o.offsetHeight,l=e.getRect(o),c=Math.max(0,Math.min(n-l[r],a));return e.setCss(i,s,c+"px"),{barPosition:a,barThumbPosition:c}}function ee(e,t){const{isAlphaHorizontal:o,$Dom:{alphaBar:i,alphaBarThumb:n}}=e,r=K(o,i,n,t),{barPosition:s,barThumbPosition:a}=r;let l=s-a<=0?0:s-a,c=o?1-l/s:l/s;e.hsvaColor.a=c>=1?1:c.toFixed(2),y(e,!0)}function te(t,o){const{isHueHorizontal:i,$Dom:{hueBar:n,hueThumb:r,pickerPanel:s},hsvaColor:a}=t;let l=K(i,n,r,o);const{barThumbPosition:c,barPosition:h}=l;t.hsvaColor.h=_(a).h=parseInt(360*c/h),e.setCss(s,"background",g(b(_(t.hsvaColor)))),y(t)}function oe(t,o,i,n,r){e.setSomeCss(t.$Dom.pickerCursor,[{prop:"left",value:o+"px"},{prop:"top",value:i+"px"}]);const s=parseInt(100*(o-4)/n),a=parseInt(100*(r-(i-4))/r);t.hsvaColor.s=s>100?100:s<0?0:s,t.hsvaColor.v=a>100?100:a<0?0:a,t.boxChange=!0,y(t)}function ie(t,o){t.map(t=>{[{type:"click",handler:i=>{var n;e.addClass(t,"ew-pre-define-color-active"),(n=t,Array.prototype.filter.call(n.parentElement.children,e=>e!==n)).forEach(t=>e.removeClass(t,"ew-pre-define-color-active"));const r=e.getCss(i.target,"background-color");o.hsvaColor=w(r),T(o,o.panelWidth,o.panelHeight,!0),y(o)}},{type:"blur",handler:t=>e.removeClass(t.target,"ew-pre-define-color-active")}].forEach(i=>{o.config.disabled||-1!==e.ewObjToArray(t.classList).indexOf("ew-pre-define-color-disabled")||e.on(t,i.type,i.handler)})})}function ne(e){let t=e.slice(e.indexOf("(")+1,e.lastIndexOf(")")).split(",")[3];return{"ew-has-alpha":x(e)&&t<1&&t>0}}let re=0;class se{constructor(){this.id=re++,this.subs=[]}addSub(e){this.subs.push(e)}removeSub(e){!function(e,t){if(e.length){let o=e.indexOf(t);if(o>-1)e.splice(o,1)}}(this.subs,e)}notify(e){const t=this.subs.slice();for(let o=0,i=t.length;o<i;o++)t[o].update(e)}depend(){se.DepTarget&&se.DepTarget.addDep(this)}}se.id=re,se.subs=[],se.DepTarget=null;const ae=["el","isLog"],le=e=>-1===ae.indexOf(e);class ce{constructor(e){this.value={...e},this.reactive=null,this.dep=new se,function(e,t,o,i){Object.defineProperty(e,t,{enumerable:!!i,value:o,writable:!0,configurable:!0})}(e,"__ew__color__picker__ob__",this),this.walk(this.value)}walk(e){this.reactive=function(e,t){const o=t=>{se.DepTarget&&le(t)&&e.notify(t)};return new Proxy(t,{get(t,o,i){let n=Reflect.get(t,o,i);return se.DepTarget&&le(o)&&e.depend(),n},set(e,t,i){let n=Reflect.set(e,t,i);return o(t),n},has:(e,t)=>t in e&&!(t in Object.prototype)&&Reflect.has(e,t),deleteProperty(e,t){if(this.has(e,t)){let i=Reflect.deleteProperty(e,t);return o(t),i}}})}(this.dep,e)}}const he=["pickerAnimation","pickerAnimationTime","sure","clear","togglePicker","changeColor"];function pe(e,t,o){return new Promise((i,n)=>{e?o.appendChild(t):t.remove(),i()})}function ue(e,t,o){U(e).then(({clearText:e,sureText:i})=>{t.textContent=e,o.textContent=i})}function de(t,o,i){he.indexOf(o)>-1||setTimeout(()=>{const{$Dom:{hueBar:n,alphaBar:r,box:s,pickerSure:a,pickerClear:l,rootElement:c,pickerInput:h,picker:p},$cacheDom:{hueContainer:u,alphaContainer:d},config:{hue:f,alpha:m,isClickOutside:g,hasInput:b,pickerAnimationTime:C}}=t;switch(o){case"hue":pe(f,n,u).then(()=>E(t));break;case"alpha":pe(m,r,d).then(()=>E(t));break;case"size":Y(t,t.config).then(({b_width:t,b_height:o})=>function(t,o,i){if(t){const n=t.firstElementChild;e.hasClass(n,"ew-color-picker-no")&&e.setCss(n,"line-height",i),[t,n].forEach(t=>{e.setSomeCss(t,[{prop:"width",value:o},{prop:"height",value:i}])})}}(s,t,o));break;case"isClickOutside":q(t,t.config);break;case"lang":case"userDefineText":ue(t.config,l,a);break;case"disabled":t.config[o]?e.addClass(s,"ew-color-picker-box-disabled"):e.removeClass(s,"ew-color-picker-box-disabled"),e.setCss(s,"background",t.config[o]?"":t.config.defaultColor),t.config[o]?(t._privateConfig.pickerFlag&&(t._privateConfig.pickerFlag=!1,I(H(t),p,C)),e.off(s,"click",s.clickHandler),b&&(e.hasClass(h,"ew-input-disabled")||e.addClass(h,"ew-input-disabled"),h.disabled=!0),e.hasClass(p,"ew-color-picker-disabled")||e.addClass(p,"ew-color-picker-disabled")):(b&&(e.removeClass(h,"ew-input-disabled"),h.disabled=!1),e.removeClass(p,"ew-color-picker-disabled"),e.on(s,"click",s.clickHandler))}e.isFunction(i)&&i()},t.config.pickerAnimationTime)}class fe{constructor(e){this._colorPickerInstance=e,this._watcher_id=e._color_picker_uid,this.depIds=new Set,this.dep=null,e._watcher=this,this.get()}get(){var e;e=this,se.DepTarget=e}update(e){((e,t)=>{de(e,t)})(this._colorPickerInstance,e)}cleanDeps(){this.dep&&(this.dep.subs=[])}addDep(e){const t=e.id;this.dep=e,this.depIds.has(t)||(this.depIds.add(t),e.addSub(this))}}function me(e){return e.parentElement.removeChild(e)}function ge(t){if(e.isUndefined(new.target))return e.ewError(r.CONSTRUCTOR_ERROR);Q(this,t)}return[{name:"beforeInit",func:function(t,o,i){let s,a="zh"===o.lang?j:F;s=o.userDefineText?e.ewAssign(L,a,o):e.ewAssign(L,o,a),i=i||J;let l=e.isDom(t)?t:e.isString(t)?e.$(t):e.isJQDom(t)?t.get(0):null;return l?(l=l.length?l[0]:l,l.tagName?void((t=>n.indexOf(t.tagName.toLowerCase())>-1&&(e.ewError(r.DOM_NOT_ERROR),!0))(l)||(this._color_picker_uid||(this._color_picker_uid=e.createUUID()),o.openChangeColorMode&&(this.colorMode=["hex","rgba","hsla"]),this.init(l,s))):e.ewError(i)):e.ewError(i)}},{name:"init",func:function(t,o){if(!e.isDom(t))return this.beforeInit(t,o,r.DOM_ERROR);Y(this,o=e.ewAssign(L,o)),this.render(t,o)}},{name:"render",func:function(t,o){let i="",n="",s="",a="",l="",c="",h="",p="",u="",d="",f="",m="",g="",b="",C="",v="";const w=o.predefineColor;if(!e.isDeepArray(w))return e.ewError(r.PREDEFINE_COLOR_ERROR);w.length&&w.forEach((t,o)=>{const n=e.isString(t)&&D(t),r=e.isDeepObject(t)&&t.hasOwnProperty("color")&&D(t.color),s=n?t:r?t.color:"";let a={"ew-pre-define-color":!0,...ne(s)};r&&(a=e.ewAssign(a,{"ew-pre-define-color-disabled":t.disabled}));const l=e.classnames(a);i+=`\n                <div class="${l}" tabindex=${o}>\n                    <div class="ew-pre-define-color-item" style="background-color:${s};"></div>\n                </div>\n            `});const{b_width:x,b_height:$}=this._privateConfig.boxSize,O=`width:${x};height:${$};`,R=`${O}line-height:${$};`,y=o.defaultColor?`<div class="ew-color-picker-arrow" style="${O}">\n<svg \n    t="1634963310652" \n    class="ew-color-picker-arrow-icon" \n    viewBox="0 0 1024 1024" \n    version="1.1" \n    xmlns="http://www.w3.org/2000/svg" \n    p-id="3223"\n>\n    <path \n        d="M512 714.666667c-8.533333 0-17.066667-2.133333-23.466667-8.533334l-341.333333-341.333333c-12.8-12.8-12.8-32 \n        0-44.8 12.8-12.8 32-12.8 44.8 0l320 317.866667 317.866667-320c12.8-12.8 32-12.8 44.8 0 12.8 12.8 12.8 32 0 \n        44.8L533.333333 704c-4.266667 8.533333-12.8 10.666667-21.333333 10.666667z" \n        p-id="3224"\n    >\n    </path>\n</svg>\n</div>`:`<div class="ew-color-picker-no" style="${R}">\n<svg \n    t="1634963211095" \n    class="ew-color-picker-close-icon" \n    viewBox="0 0 1024 1024" \n    version="1.1" \n    xmlns="http://www.w3.org/2000/svg" \n    p-id="2424">\n    <path \n        d="M504.224 470.288l207.84-207.84a16 16 0 0 1 22.608 0l11.328 11.328a16 16 0 0 1 0 22.624l-207.84 \n        207.824 207.84 207.84a16 16 0 0 1 0 22.608l-11.328 11.328a16 16 0 0 1-22.624 0l-207.824-207.84-207.84 \n        207.84a16 16 0 0 1-22.608 0l-11.328-11.328a16 16 0 0 1 0-22.624l207.84-207.824-207.84-207.84a16 16 0 0 \n        1 0-22.608l11.328-11.328a16 16 0 0 1 22.624 0l207.824 207.84z" p-id="2425"\n    >\n    </path>\n    </svg>\n</div>`;if(o.alpha&&(n='<div class="ew-alpha-slider-bar">\n            <div class="ew-alpha-slider-wrapper"></div>\n            <div class="ew-alpha-slider-bg"></div>\n            <div class="ew-alpha-slider-thumb"></div>\n        </div>'),o.hue&&(s='<div class="ew-color-slider-bar"><div class="ew-color-slider-thumb"></div></div>'),i&&(a=`<div class="ew-pre-define-color-container">${i}</div>`),(o.disabled||o.boxDisabled)&&(l="ew-color-picker-box-disabled"),o.defaultColor){if(!D(o.defaultColor))return e.ewError(r.DEFAULT_COLOR_ERROR);o.defaultColor=k(o.defaultColor)}this._privateConfig.colorValue=o.defaultColor,!o.disabled&&this._privateConfig.colorValue&&(c="background:"+this._privateConfig.colorValue);const _=`${O};${c}`;if(o.hasBox&&(h=`<div class="ew-color-picker-box ${l}" tabIndex="0" style="${_}">${y}</div>`),o.hasClear&&(p=`<button class="ew-color-clear ew-color-drop-btn">${o.clearText}</button>`),o.hasSure&&(u=`<button class="ew-color-sure ew-color-drop-btn">${o.sureText}</button>`),(o.hasClear||o.hasSure)&&(f=`<div class="ew-color-drop-btn-group">${p}${u}</div>`),o.hasInput&&(d='<input type="text" class="ew-color-input">'),o.openChangeColorMode){if(!o.alpha||!o.hue)return e.ewError(r.COLOR_MODE_ERROR);g='<div class="ew-color-mode-container">\n        <div class="ew-color-mode-up"></div>\n        <div class="ew-color-mode-down"></div>\n        </div>',b=`<label class="ew-color-mode-title">${this.colorMode[1]}</label>`}(o.hasInput||o.hasClear||o.hasSure)&&(m=o.openChangeColorMode?`<div class="ew-color-drop-container ew-has-mode-container">\n        ${b}${d}${g}\n        </div><div class="ew-color-drop-container">\n        ${f}\n        </div>`:`<div class="ew-color-drop-container">\n        ${d}${f}\n        </div>`),this.isAlphaHorizontal="horizontal"===o.alphaDirection,this.isHueHorizontal="horizontal"===o.hueDirection,this.isAlphaHorizontal&&this.isHueHorizontal?C=s+n:this.isAlphaHorizontal||this.isHueHorizontal?this.isHueHorizontal?(C=s,v=n):(C=n,v=s):v=n+s,C&&(C=`<div class="ew-color-slider ew-is-horizontal">${C}</div>`),v&&(v=`<div class="ew-color-slider ew-is-vertical">${v}</div>`);const T=`${h}\n        <div class="ew-color-picker">\n            <div class="ew-color-picker-content">\n                <div class="ew-color-panel" style="background:red;">\n                    <div class="ew-color-white-panel"></div>\n                    <div class="ew-color-black-panel"></div>\n                    <div class="ew-color-cursor"></div>\n                </div>\n                ${v}\n            </div>\n            ${C}\n            ${m}\n            ${a}\n        </div>`;let E="body"===t.tagName.toLowerCase(),A=document.createElement("div"),M=E?A.cloneNode(!0):t;if(M.setAttribute("color-picker-id",this._color_picker_uid),E){M.setAttribute("id","placeElement-"+this._color_picker_uid);let o=e.$("#placeElement-"+this._color_picker_uid);o&&o.parentElement.removeChild(o),M.innerHTML=T,e.addClass(A,"ew-color-picker-container"),A.appendChild(M),t.appendChild(A)}else t.innerHTML=`<div class="ew-color-picker-container">${T}</div>`;this._watcher=new fe(this),this.config=new ce(o).reactive,this.startMain(M,o)}},{name:"startMain",func:function(t,o){let i=this;this.$Dom=Object.create(null),this.$cacheDom=Object.create(null),this.$Dom.rootElement=t,this.$Dom.picker=Z(t,"ew-color-picker"),this.$Dom.pickerPanel=Z(t,"ew-color-panel"),this.$Dom.pickerCursor=Z(t,"ew-color-cursor"),(this.isHueHorizontal||this.isAlphaHorizontal)&&(this.$Dom.horizontalSlider=Z(t,"ew-is-horizontal")),this.isHueHorizontal&&this.isAlphaHorizontal||(this.$Dom.verticalSlider=Z(t,"ew-is-vertical")),M(this,o);const n=this.panelWidth=parseInt(e.getCss(this.$Dom.pickerPanel,"width")),r=this.panelHeight=parseInt(e.getCss(this.$Dom.pickerPanel,"height")),s=e.getRect(t);if(this.panelLeft=s.left,this.panelTop=s.top+s.height,this.$Dom.preDefineItem=Z(t,"ew-pre-define-color",!0),this.$Dom.preDefineItem.length){const t=e.ewObjToArray(this.$Dom.preDefineItem);this.$cacheDom.preDefineItemContainer=t[0].parentElement,ie(t,i)}var a;if(o.hue&&(this.$Dom.hueBar=Z(t,"ew-color-slider-bar"),this.$Dom.hueThumb=Z(t,"ew-color-slider-thumb"),this.$cacheDom.hueContainer=this.$Dom.hueBar.parentElement,o.disabled||(e.on(this.$Dom.hueBar,"click",e=>te(i,this.isHueHorizontal?e.x:e.y)),this.bindEvent(this.$Dom.hueThumb,(e,t,o,i)=>te(e,this.isHueHorizontal?o:i)))),o.alpha&&(this.$Dom.alphaBar=Z(t,"ew-alpha-slider-bar"),this.$Dom.alphaBarBg=Z(t,"ew-alpha-slider-bg"),this.$Dom.alphaBarThumb=Z(t,"ew-alpha-slider-thumb"),this.$cacheDom.alphaContainer=this.$Dom.alphaBar.parentElement,o.disabled||(this.bindEvent(this.$Dom.alphaBarThumb,(e,t,o,i)=>ee(e,this.isAlphaHorizontal?o:i)),e.on(this.$Dom.alphaBar,"click",e=>ee(i,this.isAlphaHorizontal?e.x:e.y)))),function(t){const o=H(t);e.setCss(t.$Dom.picker,o?"display":"opacity",o?"none":0)}(i),o.hasBox?(this.$Dom.box=Z(t,"ew-color-picker-box"),o.boxDisabled||o.disabled||(this.$Dom.box.clickHandler=()=>P(t,i,e=>{e&&(M(this,o),T(i,i.panelWidth,i.panelHeight,!1))}),e.on(this.$Dom.box,"click",this.$Dom.box.clickHandler))):(a=this,setTimeout(()=>{const t=H(a);a._privateConfig.pickerFlag=!0,"none"===e.getCss(a.$Dom.picker,"display")&&S(t,a.$Dom.picker,a.config.pickerAnimationTime),T(a,a.panelWidth,a.panelHeight,!1)},0)),o.hasInput&&(this.$Dom.pickerInput=Z(t,"ew-color-input"),e.on(this.$Dom.pickerInput,"blur",t=>function(t,o){if(!D(o)||e.removeAllSpace(t.prevInputValue)===e.removeAllSpace(o))return;let i=null;if(t.config.openChangeColorMode)switch(t.currentMode){case"hex":i=w(m(o));break;case"rgba":i=w(o);break;case"hsla":let e=o.slice(o.indexOf("(")+1,o.lastIndexOf(")")).split(",");i=w(C({h:Number(e[0]),s:Number(e[1].replace(/%/g,"")),l:Number(e[2].replace(/%/g,"")),a:Number(e[3])||1}))}else i=t.config.alpha?w(o):w(m(o));t.hsvaColor=i,T(t,t.panelWidth,t.panelHeight,!0)}(i,t.target.value))),o.disabled)return o.hasInput&&(e.hasClass(this.$Dom.pickerInput,"ew-input-disabled")||e.addClass(this.$Dom.pickerInput,"ew-input-disabled"),this.$Dom.pickerInput.disabled=!0),e.hasClass(this.$Dom.picker,"ew-color-picker-disabled")||e.addClass(this.$Dom.picker,"ew-color-picker-disabled"),!1;q(this,o),o.hasClear&&(this.$Dom.pickerClear=Z(t,"ew-color-clear"),e.on(this.$Dom.pickerClear,"click",()=>function(e){e._privateConfig.pickerFlag=!1,I(H(e),e.$Dom.picker,e.config.pickerAnimationTime),e.config.defaultColor=e._privateConfig.colorValue="",e.config.clear(e.config.defaultColor,e),R(e.$Dom.box,e.config.defaultColor)}(i))),o.hasSure&&(this.$Dom.pickerSure=Z(t,"ew-color-sure"),e.on(this.$Dom.pickerSure,"click",()=>function(e){const t=e.config.alpha?b(e.hsvaColor):g(b(e.hsvaColor));e._privateConfig.pickerFlag=!1,I(H(e),e.$Dom.picker,e.config.pickerAnimationTime),e.config.defaultColor=e._privateConfig.colorValue=t,y(e),e.config.sure(t,e),R(e.$Dom.box,e.config.defaultColor)}(i))),o.openChangeColorMode&&(this.$Dom.modeUp=Z(t,"ew-color-mode-up"),this.$Dom.modeDown=Z(t,"ew-color-mode-down"),this.$Dom.modeTitle=Z(t,"ew-color-mode-title"),o.hasInput&&(this.modeCount=o.alpha?1:0,this.currentMode=this.colorMode[this.modeCount],e.on(this.$Dom.modeUp,"click",e=>O(i,"up",()=>y(i))),e.on(this.$Dom.modeDown,"click",e=>O(i,"down",()=>y(i))))),e.on(this.$Dom.pickerPanel,"click",e=>function(e,t){if(t.target!==e.$Dom.pickerCursor){const o=t.layerX,i=t.layerY,n=e.$Dom.pickerPanel.offsetWidth,r=e.$Dom.pickerPanel.offsetHeight;oe(e,(o>=n-1?n:o<=0?0:o)+4,(i>=r-2?r:i<=0?0:i)+4,n,r)}}(i,e)),this.bindEvent(this.$Dom.pickerCursor,(e,t,o,i)=>{oe(e,Math.max(0,Math.min(o-e.panelLeft,n))+4,Math.max(0,Math.min(i-e.panelTop,r))+4,n,r)})}},{name:"bindEvent",func:V},{name:"updateColor",func:function(t){if(!D(t))return e.ewError(r.UPDATE_PARAM_COLOR_ERROR);this._privateConfig.pickerFlag||e.ewWarn(r.UPDATE_PARAM_COLOR_WARN);let o=k(t);this.hsvaColor=w(o),T(this,this.panelWidth,this.panelHeight,!0)}},{name:"openPicker",func:function(e,t){e&&(this.config.pickerAnimation=e),t&&(this.config.pickerAnimationTime=t),this._privateConfig.pickerFlag||(this._privateConfig.pickerFlag=!0,S(H(this),this.$Dom.picker,this.config.pickerAnimationTime),T(this,this.panelWidth,this.panelHeight,!1))}},{name:"closePicker",func:function(e,t){e&&(this.config.pickerAnimation=e),t&&(this.config.pickerAnimationTime=t),this._privateConfig.pickerFlag&&(this._privateConfig.pickerFlag=!1,I(H(this),this.$Dom.picker,this.config.pickerAnimationTime))}},{name:"destroy",func:function(){const t=this.$Dom.rootElement,o=t.parentElement;e.hasClass(o,"ew-color-picker-container")&&o?me(o):t&&me(t)}}].forEach(t=>e.addMethod(ge,t.name,t.func)),Object.keys(G).forEach(e=>{ge[e]=G[e]}),ge}));
