!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ewColorPicker=t()}(this,(function(){"use strict";const e=Object.create(null),t=Object.prototype.toString;["Number","String","Function","Undefined","Boolean"].forEach(t=>e["is"+t]=e=>typeof e===t.toLowerCase()),e.addMethod=(e,t,o)=>(e.prototype[t]=o,e),["Object","Array","RegExp"].forEach(o=>e["isDeep"+o]=e=>t.call(e).slice(8,-1).toLowerCase()===o.toLowerCase()),e.isShallowObject=t=>"object"==typeof t&&!e.isNull(t),e.ewObjToArray=t=>e.isShallowObject(t)?Array.prototype.slice.call(t):t,e.isNull=e=>null===e,e.ewAssign=function(t,o){if(!e.isNull(t)){if(Object.assign)return Object.assign(t,o);{const e=Object(t);for(let t=1,o=arguments.length;t<o;t+=1){const o=arguments[t];if(o)for(let t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e}}},e.addClass=(e,t)=>e.classList.add(t),e.removeClass=(e,t)=>e.classList.remove(t),e.hasClass=(t,o)=>{let r=e=>new RegExp(" "+t.className+" ").test(" "+e+" ");return e.isDeepArray(o)?o.some(e=>r(e)):r(o)},e.setCss=(e,t,o)=>e.style[t]=o,e.setSomeCss=(t,o=[])=>{o.length&&o.forEach(o=>e.setCss(t,o.prop,o.value))},e.isDom=t=>e.isShallowObject(HTMLElement)?t instanceof HTMLElement:t&&e.isShallowObject(t)&&1===t.nodeType&&e.isString(t.nodeName)||t instanceof HTMLCollection||t instanceof NodeList,e.ewError=e=>console.error("[ewColorPicker warn]\n"+new Error(e)),e.ewWarn=e=>console.warn("[ewColorPicker warn]\n"+e),e.deepCloneObjByJSON=e=>JSON.parse(JSON.stringify(e)),e.deepCloneObjByRecursion=function t(o){if(!e.isShallowObject(o))return;let r=e.isDeepArray(o)?[]:{};for(let i in o)r[i]=e.isShallowObject(o[i])?t(o[i]):o[i];return r},e.getCss=(e,t)=>window.getComputedStyle(e,null)[t],e.$=e=>document[e&&e.indexOf("#")>-1?"querySelector":"querySelectorAll"](e),e.on=(e,t,o,r=!1)=>{e&&t&&o&&e.addEventListener(t,o,r)},e.off=(e,t,o,r=!1)=>{e&&t&&o&&e.removeEventListener(t,o,r)},e.getRect=e=>e.getBoundingClientRect(),e.clickOutSide=(t,o,r)=>{t.rootElement;const i=n=>{const s=e.getRect(t.picker);let a=null;o.hasBox&&(a=e.getRect(t.box));const l=n.target;if(!l)return;const c=e.getRect(l);if(o.hasBox){if(c.x>=s.x&&c.y>=s.y&&c.width<=s.width)return;if(c.x>=a.x&&c.y>=a.y&&c.width<=a.width&&c.height<=a.height)return;r()}else{if(c.x>=s.x&&c.y>=s.y&&c.width<=s.width&&c.height<=s.height)return;r()}setTimeout(()=>{e.off(document,e.eventType[0],i)})};e.on(document,e.eventType[0],i)},e.createUUID=()=>(1e7*Math.random()).toString(16).substr(0,4)+"-"+(new Date).getTime()+"-"+Math.random().toString().substr(2,5),e.removeAllSpace=e=>e.replace(/\s+/g,""),e.eventType=navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];const o=["html","head","meta","title","link","style","script"],r={PICKER_OBJECT_CONFIG_ERROR:"you should pass a param which is el and el must be a string or a dom element!",PICKER_CONFIG_ERROR:"you should pass a param that it must be a string or a dom element!",DOM_OBJECT_ERROR:"can not find the element by el property,make sure to pass a correct value!",DOM_ERROR:"can not find the element,make sure to pass a correct param!",CONFIG_SIZE_ERROR:"the value must be a string which is one of the normal,medium,small,mini,or must be an object and need to contain width or height property!",DOM_NOT_ERROR:"Do not pass these elements: "+o.join(",")+" as a param,pass the correct element such as div!",PREDEFINE_COLOR_ERROR:'"predefineColor" is a array that is need to contain color value!',CONSTRUCTOR_ERROR:"ewColorPicker is a constructor and should be called with the new keyword!",DEFAULT_COLOR_ERROR:'the "defaultColor" is not an invalid color,make sure to use the correct color!',UPDATE_PARAM_COLOR_ERROR:"the param is not a invalid color,make sure to use the correct color!",UPDATE_PARAM_COLOR_WARN:"the color picker is hided,make sure showing it and then updating the color!",COLOR_MODE_ERROR:"To turn on the mode for changing the color, the 'alpha' property and the 'hue' property should be set to true!"},i={};function n(){this.timers=[],this.args=[],this.isTimerRun=!1}n.makeTimerManage=function(e){const t=e.TimerManage;t&&t.constructor===n||(e.TimerManage=new n)};function s(e){const t=e.TimerManage;t&&t.constructor===n&&t.next()}function a(t,o,r){let i="",n="";t.indexOf("slide")>-1?(i="height"+r+" ms",n="hidden",function(){const i=t.toLowerCase().indexOf("down")>-1;i&&e.setCss(o,"display","block");let n=o.offsetHeight,a=i?0:n,l=n/(r/10);i&&e.setCss(o,"height","0px");let c=setInterval(()=>{a=i?a+l:a-l,e.setCss(o,"height",a+"px"),(a>=n||a<=0)&&(clearInterval(c),e.setCss(o,"height",n+"px"),s(o)),!i&&a<=0&&e.setCss(o,"display","none")},10)}()):(i="opacity"+r+" ms",n="",function(){const i=t.toLowerCase().indexOf("in")>-1;let n=null,a=100/(r/10),l=i?0:100;e.setSomeCss(o,[{prop:"display",value:i?"none":"block"},{prop:"opacity",value:i?0:1}]);let c=function(){l=i?l+a:l-a,"none"===o.style.display&&i&&e.setCss(o,"display","block"),e.setCss(o,"opacity",(l/100).toFixed(2)),l>=100||l<=0?(n&&clearTimeout(n),s(o),l<=0&&e.setCss(o,"display","none"),e.setCss(o,"opacity",l>=100?1:0)):n=setTimeout(c,10)};c()}()),n&&e.setCss(o,"overflow",n),e.setCss(o,"transition",i)}[{method:"add",func:function(e,t){this.timers.push(e),this.args.push(t),this.timerRun()}},{method:"timerRun",func:function(){if(!this.isTimerRun){let e=this.timers.shift(),t=this.args.shift();e&&t&&(this.isTimerRun=!0,e(t[0],t[1]))}}},{method:"next",func:function(){this.isTimerRun=!1,this.timerRun()}}].forEach(t=>e.addMethod(n,t.method,t.func)),["slideUp","slideDown","fadeIn","fadeOut"].forEach(e=>{i[e]=function(t){n.makeTimerManage(t),t.TimerManage.add((function(t,o){return a(e,t,o)}),arguments)}});const l=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,c=/[rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}/g,h=/^[rR][gG][Bb][Aa][\(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){3}[\\s]*(1|1.0|0|0?.[0-9]{1,2})[\\s]*[\)]{1}$/,d=/^[hH][Ss][Ll][\(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*)[\)]$/,u=/^[hH][Ss][Ll][Aa][\(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,){2}([\\s]*(1|1.0|0|0?.[0-9]{1,2})[\\s]*)[\)]$/;function p(t,o){let r=o||1,i=t.toLowerCase(),n=t.length,s=[];if(t&&l.test(i)){if(4===n){let e="#";for(let t=1;t<n;t++){let o=i.slice(t,t+1);e+=o.concat(o)}i=e}for(let e=1,t=i.length;e<t;e+=2)s.push(parseInt("0X"+i.slice(e,e+2),16));return e.removeAllSpace("rgba("+s.join(",")+","+r+")")}return e.removeAllSpace(i)}function f(t){const o={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};if(/rgba?/.test(t)){let r=t.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),i="";return r.map((e,t)=>{t<=2&&(i+=function(e){e=Math.min(Math.round(e),255);const t=Math.floor(e/16),r=e%16;return""+(o[t]||t)+(o[r]||r)}(e))}),e.removeAllSpace("#"+i)}}function g(t,o){let r,i,n,s=t.a,a=t.h,l=255*t.s/100,c=255*t.v/100;if(0===l)r=i=n=c;else{let e=c,t=(255-l)*c/255,o=a%60*(e-t)/60;360===a?(r=e,i=n=0):a<60?(r=e,i=t+o,n=t):a<120?(r=e-o,i=e,n=t):a<180?(r=t,i=e,n=t+o):a<240?(r=t,i=e-o,n=e):a<300?(r=t+o,i=t,n=e):a<360?(r=e,i=t,n=e-o):r=i=n=0}return(o>=0||o<=1)&&(s=o),e.removeAllSpace("rgba("+Math.ceil(r)+","+Math.ceil(i)+","+Math.ceil(n)+","+s+")")}function b(t){let o,r,i,n=t.h,s=t.s/100,a=t.l/100,l=t.a;if(0===s)o=r=i=a;else{let e=(e,t,o)=>(o>1&&(o-=1),o<0&&(o+=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+6*(t-e)*(2/3-o):e),t=a>=.5?a+s-a*s:a*(1+s),l=2*a-t,c=n/360;o=e(l,t,c+1/3),r=e(l,t,c),i=e(l,t,c-1/3)}return e.removeAllSpace(`rgba(${Math.ceil(255*o)},${Math.ceil(255*r)},${Math.ceil(255*i)},${l})`)}function m(t){const o=t.slice(t.indexOf("(")+1,t.lastIndexOf(")")).split(",");let r,i,n=o.length<4?1:Number(o[3]),s=parseInt(o[0])/255,a=parseInt(o[1])/255,l=parseInt(o[2])/255,c=Math.max(s,a,l),h=Math.min(s,a,l),d=(c+h)/2;if(c===h)r=i=0;else{const e=c-h;switch(i=d>.5?e/(2-c-h):e/(c+h),c){case s:r=(a-l)/e+(a>=l?0:6);break;case a:r=(l-s)/e+2;break;case l:r=(s-a)/e+4}}return{colorStr:e.removeAllSpace("hsla("+Math.ceil(60*r)+","+Math.ceil(100*i)+"%,"+Math.ceil(100*d)+"%,"+n+")"),colorObj:{h:r,s:i,l:d,a:n}}}function C(e){const t=e.slice(e.indexOf("(")+1,e.lastIndexOf(")")).split(",");let o,r,i,n=t.length<4?1:Number(t[3]),s=parseInt(t[0])/255,a=parseInt(t[1])/255,l=parseInt(t[2])/255,c=Math.min(s,a,l),h=i=Math.max(s,a,l),d=h-c;if(r=0===h?0:1-c/h,h===c)o=0;else{switch(h){case s:o=(a-l)/d+(a<l?6:0);break;case a:o=2+(l-s)/d;break;case l:o=4+(s-a)/d}o*=60}return r*=100,i*=100,{h:o,s:r,v:i,a:n}}function v(t){const o=document.createElement("div");e.setCss(o,"backgroundColor",t),document.body.appendChild(o);const r=e.getCss(o,"backgroundColor");document.body.removeChild(o);let i=r.match(/,/g)&&r.match(/,/g).length>2?r:r.slice(0,2)+"ba"+r.slice(3,r.length-1)+", 1)";return e.removeAllSpace(i)}function w(e){let t="transparent"===e;return l.test(e)||c.test(e)||h.test(e)||d.test(e)||u.test(e)||"rgba(0,0,0,0)"!==v(e)&&!t||t}function k(e){return c.test(e)||h.test(e)||d.test(e)||u.test(e)}var O=Object.freeze({__proto__:null,colorRegExp:l,colorRegRGB:c,colorRegRGBA:h,colorRegHSL:d,colorRegHSLA:u,colorHexToRgba:p,colorRgbaToHex:f,colorHsvaToRgba:g,colorHslaToRgba:b,colorRgbaToHsla:m,colorRgbaToHsva:C,colorToRgba:v,isValidColor:w,isAlphaColor:k});function R(e,t,o,r){r.config.defaultColor=r.config.colorValue=e,r.config.pickerFlag=t,r.render(o,r.config)}function x(e,t,o){let r=e.colorMode.length;"up"===t?e.modeCount+=1:e.modeCount-=1,e.modeCount>r-1&&(e.modeCount=0),e.modeCount<0&&(e.modeCount=r-1),e.currentMode=e.colorMode[e.modeCount],o()}function y(e,t){return e.style.setProperty("background",t)}function E(t,o){const r=g(t.hsvaColor);let i=o||t.config.alpha?r:f(r);t.config.openChangeColorMode&&(i=function(e,t){let o=null;switch(e.currentMode){case"hex":o=f(t);break;case"rgba":o=v(t);break;case"hsla":o=m(t).colorStr;break;default:o=t}return e.modeTitle.innerHTML=e.currentMode,o}(t,r)),t.pickerInput&&(t.pickerInput.value=i,t.prevInputValue=i),function(t){t.alphaBarBg&&e.setCss(t.alphaBarBg,"background","linear-gradient(to top,"+g(t.hsvaColor,0)+" 0%,"+g(t.hsvaColor,1)+" 100%)")}(t),t.config.hasBox&&t.config.changeBoxByChangeColor&&t.boxChange&&y(t.box,i),e.isFunction(t.config.changeColor)&&t.config.changeColor(i)}function T(t){const o=e.deepCloneObjByRecursion(t);return o.s=o.v=100,o}function _(t,o,r,i){t.boxChange=i,E(t),t.prevInputValue=t.pickerInput.value;let n=0,s=parseInt(t.hsvaColor.s*o/100),a=parseInt(r-t.hsvaColor.v*r/100);[{el:t.pickerCursor,prop:"left",value:s+4+"px"},{el:t.pickerCursor,prop:"top",value:a+4+"px"},{el:t.pickerPanel,prop:"background",value:f(g(T(t.hsvaColor)))}].forEach(t=>e.setCss(t.el,t.prop,t.value)),t.config.hue&&(n=t.hueBar.offsetHeight||180,e.setCss(t.hueThumb,"top",parseInt(t.hsvaColor.h*n/360)+"px")),t.config.alpha&&(n=t.alphaBar.offsetHeight||180,e.setCss(t.alphaBarThumb,"top",n-t.hsvaColor.a*n+"px"))}function M(e,t){return i[e?"slideDown":"fadeIn"](t,200)}function S(e,t){return i[e?"slideUp":"fadeOut"](t,200)}function I(t){return e.isString(t.config.openPickerAni)&&t.config.openPickerAni.indexOf("height")>-1}function A(e){e.config.pickerFlag?M(I(e),e.picker):S(I(e),e.picker)}const B=function(){},P={hue:!0,alpha:!1,size:"normal",predefineColor:[],disabled:!1,defaultColor:"",openPickerAni:"height",sure:B,clear:B,openPicker:B,isLog:!0,changeColor:B,hasBox:!0,isClickOutside:!0,hasClear:!0,hasSure:!0,hasColorInput:!0,boxDisabled:!1,openChangeColorMode:!1,changeBoxByChangeColor:!1};function D(t,o){let i=function(t){const o={...P,boxSize:{b_width:null,b_height:null},pickerFlag:!1,colorValue:""};let i,n,s=null;if(e.isString(t)||e.isDom(t))s=o,i=t,n=r.DOM_ERROR;else{if(!e.isDeepObject(t)||!e.isString(t.el)&&!e.isDom(t.el)){const o=e.isDeepObject(t)?r.PICKER_OBJECT_CONFIG_ERROR:r.PICKER_CONFIG_ERROR;return e.ewError(o)}s=e.ewAssign(o,t),i=t.el,n=r.DOM_OBJECT_ERROR}return{element:i,config:s,error:n}}(o);i&&(t.config=i.config,t.beforeInit(i.element,i.config,i.error))}const L=Object.create(null);[O,e].forEach(t=>{Object.keys(t).forEach(o=>{e.isFunction(t[o])&&(L[o]=t[o])})});var $={createColorPicker:function(e){const t=function(){D(this,e)};return(t.prototype=Object.create(this.prototype)).constructor=t,t.Super=this,new t},getDefaultConfig:function(){return P},util:L};function N(e,t,o){return o?e.querySelectorAll("."+t):e.querySelector("."+t)}function j(t,o,r){const i=t.offsetHeight,n=e.getRect(t),s=Math.max(0,Math.min(r-n.y,i));return e.setCss(o,"top",s+"px"),{barHeight:i,barThumbY:s}}function H(e,t){let o=j(e.alphaBar,e.alphaBarThumb,t);const r=(o.barHeight-o.barThumbY<=0?0:o.barHeight-o.barThumbY)/o.barHeight;e.hsvaColor.a=r>=1?1:r.toFixed(2),E(e,!0)}function F(t,o){let r=j(t.hueBar,t.hueThumb,o);t.hsvaColor.h=T(t.hsvaColor).h=parseInt(360*r.barThumbY/r.barHeight),e.setCss(t.pickerPanel,"background",f(g(T(t.hsvaColor)))),E(t)}function z(t,o,r,i,n){e.setSomeCss(t.pickerCursor,[{prop:"left",value:o+"px"},{prop:"top",value:r+"px"}]);const s=parseInt(100*(o-4)/i),a=parseInt(100*(n-(r-4))/n);t.hsvaColor.s=s>100?100:s<0?0:s,t.hsvaColor.v=a>100?100:a<0?0:a,t.boxChange=!0,E(t)}function U(t){if(e.isUndefined(new.target))return e.ewError(r.CONSTRUCTOR_ERROR);D(this,t)}return[{name:"beforeInit",func:function(t,i,n){let s=e.isDom(t)?t:e.isString(t)?e.$(t):null;return s?(s=s.length?s[0]:s,s.tagName?void((t=>o.indexOf(t.tagName.toLowerCase())>-1&&(e.ewError(r.DOM_NOT_ERROR),!0))(s)||(this._color_picker_uid=e.createUUID(),i.openChangeColorMode&&(this.colorMode=["hex","rgba","hsla"]),this.init(s,i))):e.ewError(n)):e.ewError(n)}},{name:"init",func:function(t,o){let i,n;if(o.isLog&&console.log("%c ew-color-picker@1.7.7%c 联系QQ：854806732 %c 联系微信：eveningwater %c github:https://github.com/eveningwater/ew-color-picker %c ","background:#0ca6dc ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),e.isString(o.size))switch(o.size){case"normal":i=n="40px";break;case"medium":i=n="36px";break;case"small":i=n="32px";break;case"mini":i=n="28px";break;default:i=n="40px"}else{if(!e.isDeepObject(o.size))return e.ewError(r.CONFIG_SIZE_ERROR);i=o.size.width&&e.isNumber(o.size.width)?parseInt(o.size.width)+"px":"40px",n=o.size.height&&e.isNumber(o.size.height)?parseInt(o.size.height)+"px":"40px"}o.boxSize.b_width=i,o.boxSize.b_height=n,this.render(t,o)}},{name:"render",func:function(t,o){let i="",n="",s="",a="",l="",c="",h="",d="",u="",p="",f="",g="",b="",m="";const C=o.predefineColor;if(!e.isDeepArray(C))return e.ewError(r.PREDEFINE_COLOR_ERROR);C.length&&C.map((t,o)=>{let r=e.isString(t)&&w(t),n=e.isDeepObject(t)&&t.hasOwnProperty("color")&&w(t.color),s=r?t:n?t.color:"",a=n?t.disabled?" ew-pre-define-color-disabled":"":"";i+=`\n            <div class="ew-pre-define-color${function(e){let t=e.slice(e.indexOf("(")+1,e.lastIndexOf(")")).split(",")[3];return k(e)&&t<1&&t>0?" ew-has-alpha":""}(s)}${a}" tabindex=${o}>\n                <div class="ew-pre-define-color-item" style="background-color:${s};"></div>\n            </div>`});const O=o.defaultColor?`<div class="ew-color-picker-arrow" style="width:${this.config.boxSize.b_width};height:${this.config.boxSize.b_height};">\n        <div class="ew-color-picker-arrow-left"></div>\n        <div class="ew-color-picker-arrow-right"></div>\n    </div>`:`<div class="ew-color-picker-no" style="width:${this.config.boxSize.b_width};height:${this.config.boxSize.b_height};line-height:${this.config.boxSize.b_height};">&times;</div>`;if(o.alpha&&(n='<div class="ew-alpha-slider-bar">\n            <div class="ew-alpha-slider-wrapper"></div>\n            <div class="ew-alpha-slider-bg"></div>\n            <div class="ew-alpha-slider-thumb"></div>\n        </div>'),o.hue&&(s='<div class="ew-color-slider-bar"><div class="ew-color-slider-thumb"></div></div>'),i&&(a=`<div class="ew-pre-define-color-container">${i}</div>`),(o.disabled||o.boxDisabled)&&(l="ew-color-picker-box-disabled"),o.defaultColor&&!w(o.defaultColor))return e.ewError(r.DEFAULT_COLOR_ERROR);w(o.defaultColor)&&(o.defaultColor=v(o.defaultColor)),o.colorValue=o.defaultColor,!o.disabled&&o.colorValue&&(c="background:"+o.colorValue);const R=`width:${o.boxSize.b_width};height:${o.boxSize.b_height};${c}`;if(o.hasBox&&(h=`<div class="ew-color-picker-box ${l}" tabIndex="0" style="${R}">${O}</div>`),o.hasClear&&(d='<button class="ew-color-clear ew-color-drop-btn">清空</button>'),o.hasSure&&(u='<button class="ew-color-sure ew-color-drop-btn">确定</button>'),(o.hasClear||o.hasSure)&&(f=`<div class="ew-color-drop-btn-group">${d}${u}</div>`),o.hasColorInput&&(p='<input type="text" class="ew-color-input">'),o.openChangeColorMode){if(!o.alpha||!o.hue)return e.ewError(r.COLOR_MODE_ERROR);b='<div class="ew-color-mode-container">\n        <div class="ew-color-mode-up"></div>\n        <div class="ew-color-mode-down"></div>\n        </div>',m=`<label class="ew-color-mode-title">${this.colorMode[1]}</label>`}(o.hasColorInput||o.hasClear||o.hasSure)&&(g=`<div class="ew-color-drop-container">\n        ${m}${p}${b}${f}\n        </div>`);const x=`${h}\n        <div class="ew-color-picker">\n            <div class="ew-color-picker-content">\n                <div class="ew-color-slider">${n}${s}</div>\n                <div class="ew-color-panel" style="background:red;">\n                    <div class="ew-color-white-panel"></div>\n                    <div class="ew-color-black-panel"></div>\n                    <div class="ew-color-cursor"></div>\n                </div>\n            </div>\n            ${g}\n            ${a}\n        </div>`;let y="body"===t.tagName.toLowerCase();if(y){const o=document.createElement("div");o.innerHTML=x,o.setAttribute("id","placeElement-"+this._color_picker_uid),this._bodyPlaceEle=o;let r=e.$("#placeElement-"+this._color_picker_uid);r&&r.parentElement.removeChild(r),t.appendChild(o)}else t.innerHTML=x;y?this.startMain(this._bodyPlaceEle,o):this.startMain(t,o)}},{name:"startMain",func:function(t,o){let r=this;this.rootElement=t,o.hasBox&&(this.box=N(t,"ew-color-picker-box")),this.pickerPanel=N(t,"ew-color-panel"),this.pickerCursor=N(t,"ew-color-cursor"),o.hasColorInput&&(this.pickerInput=N(t,"ew-color-input")),o.hasClear&&(this.pickerClear=N(t,"ew-color-clear")),o.hasSure&&(this.pickerSure=N(t,"ew-color-sure")),o.hue&&(this.hueBar=N(t,"ew-color-slider-bar"),this.hueThumb=N(t,"ew-color-slider-thumb")),o.openChangeColorMode&&(this.modeUp=N(t,"ew-color-mode-up"),this.modeDown=N(t,"ew-color-mode-down"),this.modeTitle=N(t,"ew-color-mode-title")),this.picker=N(t,"ew-color-picker"),this.slider=N(t,"ew-color-slider"),o.defaultColor?this.hsvaColor=h.test(o.defaultColor)?C(o.defaultColor):C(v(o.defaultColor)):this.hsvaColor={h:0,s:100,v:100,a:1};const i=this.panelWidth=parseInt(e.getCss(this.pickerPanel,"width")),n=this.panelHeight=parseInt(e.getCss(this.pickerPanel,"height"));let s=t,a=s.offsetTop,l=s.offsetLeft;for(;s.offsetParent;)a+=s.offsetParent.offsetTop,l+=s.offsetParent.offsetLeft,s=s.offsetParent;if(this.panelLeft=l,this.panelTop=a+t.offsetHeight,this.preDefineItem=N(t,"ew-pre-define-color",!0),this.preDefineItem.length){const t=e.ewObjToArray(this.preDefineItem),s=e=>Array.prototype.filter.call(e.parentElement.children,t=>t!==e);t.map(t=>{[{type:"click",handler:o=>{e.addClass(t,"ew-pre-define-color-active"),s(t).forEach(t=>e.removeClass(t,"ew-pre-define-color-active"));const a=e.getCss(o.target,"background-color");r.hsvaColor=C(a),_(r,i,n,!0),E(r)}},{type:"blur",handler:t=>e.removeClass(t.target,"ew-pre-define-color-active")}].forEach(r=>{o.disabled||-1!==e.ewObjToArray(t.classList).indexOf("ew-pre-define-color-disabled")||e.on(t,r.type,r.handler)})})}this.picker.style[I(r)?"display":"opacity"]=I(r)?"none":0;const c=o.alpha||o.hue?o.alpha&&o.hue?27:14:0,d=o.alpha||o.hue?o.alpha&&o.hue?320:300:280;if(this.slider.style.width=c+"px",this.picker.style.minWidth=d+"px",o.alpha&&(this.alphaBar=N(t,"ew-alpha-slider-bar"),this.alphaBarBg=N(t,"ew-alpha-slider-bg"),this.alphaBarThumb=N(t,"ew-alpha-slider-thumb"),o.disabled||(this.bindEvent(this.alphaBarThumb,(e,t,o,r)=>H(e,r)),e.on(this.alphaBar,"click",e=>H(r,e.y)))),o.hasBox||(this.config.pickerFlag=!0,M(I(r),this.picker),_(this,this.panelWidth,this.panelHeight,!1)),o.disabled)return o.hasColorInput&&(e.hasClass(this.pickerInput,"ew-input-disabled")||(this.pickerInput.classList.add("ew-input-disabled"),this.pickerInput.disabled=!0)),e.hasClass(this.picker,"ew-color-picker-disabled")||this.picker.classList.add("ew-color-picker-disabled"),!1;o.hasColorInput&&e.on(this.pickerInput,"blur",t=>function(t,o){if(!w(o))return;if(e.removeAllSpace(t.prevInputValue)===e.removeAllSpace(o))return;let r=null;if(t.config.openChangeColorMode)switch(t.currentMode){case"hex":r=C(p(o));break;case"rgba":r=C(o);break;case"hsla":let e=o.slice(o.indexOf("(")+1,o.lastIndexOf(")")).split(",");r=C(b({h:Number(e[0]),s:Number(e[1].replace(/%/g,"")),l:Number(e[2].replace(/%/g,"")),a:1|Number(e[3])}))}else r=t.config.alpha?C(o):C(p(o));t.hsvaColor=r,_(t,t.panelWidth,t.panelHeight,!0),E(t)}(r,t.target.value)),o.hasClear&&e.on(this.pickerClear,"click",()=>function(e,t){R("",!1,e,t),A(t),t.config.clear(t.config.defaultColor,t)}(t,r)),o.hasSure&&e.on(this.pickerSure,"click",()=>function(e,t){const o=t.config.alpha?g(t.hsvaColor):f(g(t.hsvaColor));R(o,!1,e,t),A(t),E(t),t.config.sure(o,t)}(t,r)),o.isClickOutside&&function(t,o){e.clickOutSide(t,o,()=>{o.pickerFlag&&(o.pickerFlag=!1,S(I({config:o}),t.picker),o.hasBox&&o.changeBoxByChangeColor&&y(t.box,o.defaultColor))})}(this,o),o.hasBox&&!o.boxDisabled&&e.on(this.box,"click",()=>function(t,o){o.config.pickerFlag=!o.config.pickerFlag,R(o.config.defaultColor,o.config.pickerFlag,t,o),_(o,o.panelWidth,o.panelHeight,!1),A(o),e.isFunction(o.config.openOrClosePicker)&&o.config.openOrClosePicker(t,o)}(t,r)),o.openChangeColorMode&&o.hasColorInput&&(this.modeCount=o.alpha?1:0,this.currentMode=this.colorMode[this.modeCount],e.on(this.modeUp,"click",e=>x(r,"up",()=>E(r))),e.on(this.modeDown,"click",e=>x(r,"down",()=>E(r)))),e.on(this.pickerPanel,"click",e=>function(e,t){if(t.target!==e.pickerCursor){const o=t.layerX,r=t.layerY,i=e.pickerPanel.offsetWidth,n=e.pickerPanel.offsetHeight;z(e,(o>=i-1?i:o<=0?0:o)+4,(r>=n-2?n:r<=0?0:r)+4,i,n)}}(r,e)),this.bindEvent(this.pickerCursor,(e,t,o,r)=>{z(e,Math.max(0,Math.min(o-e.panelLeft,i))+4,Math.max(0,Math.min(r-e.panelTop,n))+4,i,n)}),o.hue&&(e.on(this.hueBar,"click",e=>F(r,e.y)),this.bindEvent(this.hueThumb,(e,t,o,r)=>F(e,r)))}},{name:"bindEvent",func:function(t,o,r){const i=this;e.on(t,e.eventType[0],()=>{const n=n=>{var s;n.preventDefault(),s=n,i.moveX=e.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientX:s.clientX,i.moveY=e.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientY:s.clientY,r?o(i,i.moveX,i.moveY):o(i,t,i.moveX,i.moveY)},s=()=>{e.off(document,e.eventType[1],n),e.off(document,e.eventType[2],s)};e.on(document,e.eventType[1],n),e.on(document,e.eventType[2],s)})}},{name:"updateColor",func:function(t){if(!w(t))return e.ewError(r.UPDATE_PARAM_COLOR_ERROR);this.config.pickerFlag||e.ewWarn(r.UPDATE_PARAM_COLOR_WARN);let o=v(t);this.hsvaColor=C(o),_(this,this.panelWidth,this.panelHeight,!0)}},{name:"openPicker",func:function(e){if(e&&(this.config.openPickerAni=e),!this.config.pickerFlag){this.config.pickerFlag=!0;const e=()=>M(I(this),this.picker),t=()=>R(this.config.defaultColor,this.config.pickerFlag,this.rootElement,this);this.config.hasBox?(t(),e()):(e(),t()),_(this,this.panelWidth,this.panelHeight,!1)}}},{name:"closePicker",func:function(e){e&&(this.config.openPickerAni=e),this.config.pickerFlag&&(this.config.pickerFlag=!1,S(I(this),this.picker))}}].forEach(t=>e.addMethod(U,t.name,t.func)),Object.keys($).forEach(e=>{U[e]=$[e]}),U}));
