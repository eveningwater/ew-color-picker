!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ewColorPicker=t()}(this,(function(){"use strict";let e=(e,t,o)=>(e.prototype[t]=o,e);const t=Object.create(null),o=Object.prototype.toString;function i(e,t){let o=t||1,i=e.toLowerCase(),n=e.length,r=[];if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(i)){if(4===n){let e="#";for(let t=1;t<n;t++){let o=i.slice(t,t+1);e+=o.concat(o)}i=e}for(let e=1,t=i.length;e<t;e+=2)r.push(parseInt("0X"+i.slice(e,e+2),16));return"rgba("+r.join(",")+","+o+")"}return i}function n(e){const t={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};if(/rgba?/.test(e)){let o=e.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),i="";return o.map((function(e,o){o<=2&&(i+=function(e){e=Math.min(Math.round(e),255);const o=Math.floor(e/16),i=e%16;return""+(t[o]||o)+(t[i]||i)}(e))})),"#"+i}}function r(e,t){let o,i,n,r=e.a,s=Math.round(e.h),a=Math.round(255*e.s/100),c=Math.round(255*e.b/100);if(0===a)o=i=n=c;else{let e=c,t=(255-a)*c/255,r=s%60*(e-t)/60;360===s?(o=e,i=n=0):s<60?(o=e,i=t+r,n=t):s<120?(o=e-r,i=e,n=t):s<180?(o=t,i=e,n=t+r):s<240?(o=t,i=e-r,n=e):s<300?(o=t+r,i=t,n=e):s<360?(o=e,i=t,n=e-r):o=i=n=0}return(t>=0||t<=1)&&(r=t),"rgba("+Math.round(o)+","+Math.round(i)+","+Math.round(n)+","+r+")"}function s(e){const t=e.slice(e.indexOf("(")+1,e.lastIndexOf(")")).split(",");let o,i,n,r=t.length<4?1:Number(t[3]),s=Number(t[0])/255,a=Number(t[1])/255,c=Number(t[2])/255,l=Math.min(s,a,c),h=n=Math.max(s,a,c),d=h-l;if(h===l)o=0;else{switch(h){case s:o=(a-c)/d+(a<c?6:0);break;case a:o=2+(c-s)/d;break;case c:o=4+(s-a)/d}o=Math.round(60*o)}return i=0===h?0:1-l/h,i=Math.round(100*i),n=Math.round(100*n),{h:o,s:i,b:n,a:r}}function a(e){const t=document.createElement("div");t.style.backgroundColor=e,document.body.appendChild(t);const o=window.getComputedStyle(t).backgroundColor;return document.body.removeChild(t),o.slice(0,2)+"ba"+o.slice(3,o.length-1)+", 1)"}function c(e){return/^rgb\(([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\)$/i.test(e)||/^#([0-9a-f]{6}|[0-9a-f]{3})$/i.test(e)||/^rgba\(([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,(1|1.0|0.[0-9])\)$/i.test(e)}["Number","String","Function","Undefined"].forEach(e=>t["is"+e]=t=>typeof t===e.toLowerCase()),t.addMethod=e,["Object","Array","RegExp"].forEach(e=>t["isDeep"+e]=t=>o.call(t).slice(8,-1).toLowerCase()===e.toLowerCase()),t.isShallowObject=e=>"object"==typeof e&&!t.isNull(e),t.ewObjToArray=e=>t.isShallowObject(e)?Array.prototype.slice.call(e):e,t.isNull=e=>null===e,t.ewAssign=(e,o)=>{if(!t.isNull(e)){if(Object.assign)return Object.assign(e,o);{const t=Object(e);for(let e=1,o=arguments.length;e<o;e+=1){const o=arguments[e];if(o)for(let e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])}return t}}},t.addClass=(e,t)=>e.classList.add(t),t.removeClass=(e,t)=>e.classList.remove(t),t.setCss=(e,t,o)=>e.style[t]=o,t.isDom=e=>t.isShallowObject(HTMLElement)?e instanceof HTMLElement:e&&t.isShallowObject(e)&&1===e.nodeType&&t.isString(e.nodeName)||e instanceof HTMLCollection||e instanceof NodeList,t.ewError=e=>console.error("[ewColorPicker warn]\n"+new Error(e)),t.deepCloneObjByJSON=e=>JSON.parse(JSON.stringify(e)),t.deepCloneObjByRecursion=function e(o){if(!t.isShallowObject(o))return;let i=t.isDeepArray(o)?[]:{};for(let n in o)i[n]=t.isShallowObject(o[n])?e(o[n]):o[n];return i},t.getCss=(e,t)=>{const o=e.currentStyle?function(t){const i=e.currentStyle[t];if(i.indexOf("height")>-1&&i.search(/px/i)>-1){const t=e.getBoundingClientRect;return t.bottom-t.top-parseInt(o("padding-bottom"))-parseInt(o("padding-top"))+"px"}}:function(t){return window.getComputedStyle(e,null)[t]};return o(t)},t.$=e=>document.querySelector(e),t.$$=e=>document.querySelectorAll(e),t.on=(e,t,o,i=!1)=>{e&&t&&o&&e.addEventListener(t,o,i)},t.off=(e,t,o,i=!1)=>{e&&t&&o&&e.removeEventListener(t,o,i)},t.hasCssOrHasStyle=e=>{const o=t.$$("style"),i=t.$$("link"),n=(t,o)=>{if(t)for(let i=0,n=t.length;i<n;i++)if(t[i][o].indexOf(e)>-1)return!0;return!1};return n(o,"textContent")||n(i,"href")},t.eventType=navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];const l={};function h(){this.timers=[],this.args=[],this.isTimerRun=!1}h.makeTimerManage=function(e){const t=e.TimerManage;t&&t.constructor===h||(e.TimerManage=new h)};const d=[{method:"add",func:function(e,t){this.timers.push(e),this.args.push(t),this.timerRun()}},{method:"timerRun",func:function(){if(!this.isTimerRun){let e=this.timers.shift(),t=this.args.shift();e&&t&&(this.isTimerRun=!0,e(t[0],t[1]))}}},{method:"next",func:function(){this.isTimerRun=!1,this.timerRun()}}];function p(e){const t=e.TimerManage;t&&t.constructor===h&&t.next()}function u(e,o,i){let n="",r="";e.indexOf("slide")>-1?(n="height"+i+" ms",r="hidden",function(){const n=e.toLowerCase().indexOf("down")>-1;n&&t.setCss(o,"display","block");let r=o.offsetHeight,s=n?0:r,a=r/(i/10);n&&t.setCss(o,"height","0px");let c=setInterval(()=>{s=n?s+a:s-a,t.setCss(o,"height",s+"px"),(s>=r||s<=0)&&(clearInterval(c),t.setCss(o,"height",r+"px"),p(o)),!n&&s<=0&&t.setCss(o,"display","none")},10)}()):(n="opacity"+i+" ms",r="",function(){const n=e.toLowerCase().indexOf("in")>-1;let r=null,s=100/(i/10),a=n?0:100;t.setCss(o,"display",n?"none":"block"),t.setCss(o,"opacity",n?0:1);let c=function(){a=n?a+s:a-s,"none"===o.style.display&&n&&t.setCss(o,"display","block"),t.setCss(o,"opacity",(a/100).toFixed(2)),a>=100||a<=0?(r&&clearTimeout(r),p(o),a<=0&&t.setCss(o,"display","none"),t.setCss(o,"opacity",a>=100?1:0)):r=setTimeout(c,10)};c()}()),r&&t.setCss(o,"overflow",r),t.setCss(o,"transition",n)}d.forEach(e=>t.addMethod(h,e.method,e.func)),["slideUp","slideDown","fadeIn","fadeOut"].forEach(e=>{l[e]=function(t){h.makeTimerManage(t),t.TimerManage.add((function(t,o){return u(e,t,o)}),arguments)}});const f=()=>console.log("%c ew-color-picker@1.5.7%c 联系QQ：854806732 %c 联系微信：eveningwater %c github:https://github.com/eveningwater/ew-color-picker %c ","background:#0ca6dc ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),b=["html","head","body","meta","title","link","style","script"],g={PICKER_OBJECT_CONFIG_ERROR:"you should pass a param which is el and el must be a string or a dom element!",PICKER_CONFIG_ERROR:"you should pass a param that it must be a string or a dom element!",DOM_OBJECT_ERROR:"can not find the element by el property,make sure to pass a correct value!",DOM_ERROR:"can not find the element,make sure to pass a correct param!",CONFIG_SIZE_ERROR:"the value must be a string which is one of the normal,medium,small,mini,or must be an object and need to contain width or height property!",DOM_NOT_ERROR:"Do not pass these elements: "+b.join(",")+" as a param,pass the correct element such as div!",PREDEFINE_COLOR_ERROR:"PredefineColor is a array that is need to contain color value!",CONSTRUCTOR_ERROR:"ewColorPicker is a constructor and should be called with the new keyword!",NO_CSS:"You need to add the style, make sure to  import a style file called ew-color-picker.min.css!"};function m(e){if(t.isUndefined(new.target))return t.ewError(g.CONSTRUCTOR_ERROR);t.hasCssOrHasStyle("ew-color-picker")||t.ewError(g.NO_CSS);const o=function(){},i={hue:!0,alpha:!1,size:"normal",predefineColor:[],disabled:!1,defaultColor:"",openPickerAni:"height",sure:o,clear:o,openPicker:o,isLog:!0};if(this.boxSize={b_width:null,b_height:null},t.isString(e)||t.isDom(e))this.config=i,this.beforeInit(e,this.config,g.DOM_ERROR);else{if(!t.isDeepObject(e)||!t.isString(e.el)&&!t.isDom(e.el)){const o=t.isDeepObject(e)?g.PICKER_OBJECT_CONFIG_ERROR:g.PICKER_CONFIG_ERROR;return t.ewError(o)}this.config=t.ewAssign(i,e),this.beforeInit(e.el,this.config,g.DOM_OBJECT_ERROR)}return this.config.pickerFlag=!1,this}const C=[{name:"beforeInit",func:function(e,o,i){o.isLog&&f();const n=e=>b.indexOf(e.tagName.toLowerCase())>-1&&(t.ewError(g.DOM_NOT_ERROR),!0),r=t.isDom(e)?e:t.isString(e)?t.$(e):null;if(r)if(r.length)t.ewObjToArray(r).forEach(e=>{n(e)||this.init(e,o)});else{if(!r.tagName)return t.ewError(i);n(r)||this.init(r,o)}else t.ewError(i)}},{name:"init",func:function(e,o){let i,n;if(t.isString(o.size))switch(o.size){case"normal":i=n="40px";break;case"medium":i=n="36px";break;case"small":i=n="32px";break;case"mini":i=n="28px";break;default:i=n="40px"}else{if(!t.isDeepObject(o.size))return t.ewError(g.CONFIG_SIZE_ERROR);i=o.size.width&&t.isNumber(o.size.width)?parseInt(o.size.width)+"px":"40px",n=o.size.height&&t.isNumber(o.size.height)?parseInt(o.size.height)+"px":"40px"}this.boxSize.b_width=i,this.boxSize.b_height=n,this.render(e,o)}},{name:"render",func:function(e,o){let i="",n="",r="",s="",a="";const l=o.predefineColor;if(!t.isDeepArray(l))return t.ewError(g.PREDEFINE_COLOR_ERROR);l.length&&l.map(e=>{c(e)&&(i+=`<div class="ew-pre-define-color" style="background:${e};"></div>`)});const h=o.defaultColor?`<div class="ew-color-picker-arrow" style="width:${this.boxSize.b_width};height:${this.boxSize.b_height};">\n                <div class="ew-color-picker-arrow-left"></div>\n                <div class="ew-color-picker-arrow-right"></div>\n            </div>`:`<div class="ew-color-picker-no" style="width:${this.boxSize.b_width};height:${this.boxSize.b_height};line-height:${this.boxSize.b_height};">&times;</div>`;o.alpha&&(n='<div class="ew-alpha-slider-bar">\n                    <div class="ew-alpha-slider-wrapper"></div>\n                    <div class="ew-alpha-slider-bg"></div>\n                    <div class="ew-alpha-slider-thumb"></div>\n                </div>'),o.hue&&(r='<div class="ew-color-slider-bar"><div class="ew-color-slider-thumb"></div></div>'),i&&(s=`<div class="ew-pre-define-color-container">${i}</div>`),o.disabled&&(a="ew-color-picker-box-disabled");const d=`\n                <div class="ew-color-picker-box ${a}" tabIndex="0" style="${`width:${this.boxSize.b_width};height:${this.boxSize.b_height};${o.defaultColor&&!o.disabled?"background:"+o.defaultColor:""}`}">${h}</div>\n                <div class="ew-color-picker">\n                    <div class="ew-color-picker-content">\n                        <div class="ew-color-slider">${n}${r}</div>\n                        <div class="ew-color-panel" style="background:red;">\n                            <div class="ew-color-white-panel"></div>\n                            <div class="ew-color-black-panel"></div>\n                            <div class="ew-color-cursor"></div>\n                        </div>\n                    </div>\n                    <div class="ew-color-drop-container">\n                        <input type="text" class="ew-color-input">\n                        <div class="ew-color-drop-btn-group">\n                            <button class="ew-color-clear ew-color-drop-btn">清空</button>\n                            <button class="ew-color-sure ew-color-drop-btn">确定</button>\n                        </div>\n                    </div>\n                    ${s}\n                </div>`;e.innerHTML=d,this.startMain(e,o)}},{name:"startMain",func:function(e,o){let i=this;this.box=w(e,"ew-color-picker-box"),this.arrowRight=w(e,"ew-color-picker-arrow-right"),this.pickerPanel=w(e,"ew-color-panel"),this.pickerCursor=w(e,"ew-color-cursor"),this.pickerInput=w(e,"ew-color-input"),this.pickerClear=w(e,"ew-color-clear"),this.pickerSure=w(e,"ew-color-sure"),this.hueBar=w(e,"ew-color-slider-bar"),this.hueThumb=w(e,"ew-color-slider-thumb"),this.picker=w(e,"ew-color-picker"),this.slider=w(e,"ew-color-slider"),this.hsbColor=this.config.defaultColor?s(a(this.config.defaultColor)):{h:0,s:100,b:100,a:1};const r=this.panelWidth=parseInt(t.getCss(this.pickerPanel,"width")),c=this.panelHeight=parseInt(t.getCss(this.pickerPanel,"height"));let l=e,h=l.offsetTop,d=l.offsetLeft;for(;l.offsetParent;)h+=l.offsetParent.offsetTop,d+=l.offsetParent.offsetLeft,l=l.offsetParent;if(this.panelLeft=d,this.panelTop=h+e.offsetHeight,this.preDefineItem=w(e,"ew-pre-define-color",!0),this.preDefineItem.length){const e=t.ewObjToArray(this.preDefineItem);e.map(o=>{[{type:"click",handler:o=>{e.forEach(e=>t.removeClass(e,"ew-pre-define-color-active")),t.addClass(o.target,"ew-pre-define-color-active"),i.hsbColor=s(t.getCss(o.target,"background-color")),_(i,r,c),M(i),T(i);const l=n(t.getCss(o.target,"background-color"));i.pickerInput.value=i.config.alpha?a(l):l}},{type:"blur",handler:e=>t.removeClass(e.target,"ew-pre-define-color-active")}].forEach(e=>t.on(o,e.type,e.handler))})}const p=o.openPickerAni.indexOf("height")>-1;this.picker.style[p?"display":"opacity"]=p?"none":0;const u=o.alpha||o.hue?o.alpha&&o.hue?27:14:0,f=o.alpha||o.hue?o.alpha&&o.hue?320:300:280;this.slider.style.width=u+"px",this.picker.style.minWidth=f+"px",o.alpha&&(this.alphaBar=w(e,"ew-alpha-slider-bar"),this.alphaBarBg=w(e,"ew-alpha-slider-bg"),this.alphaBarThumb=w(e,"ew-alpha-slider-thumb"),M(this),this.bindEvent(this.alphaBarThumb,(e,t,o,i)=>B(e,i)),t.on(this.alphaBar,"click",e=>B(i,e.y))),t.on(this.pickerInput,"blur",e=>y(i,e.target.value)),t.on(this.pickerClear,"click",()=>O(e,i)),t.on(this.pickerSure,"click",()=>R(i)),o.disabled||t.on(this.box,"click",()=>k(e,i)),t.on(this.pickerPanel,"click",e=>S(i,e)),this.bindEvent(this.pickerCursor,(e,t,o,i)=>{E(e,Math.max(0,Math.min(o-e.panelLeft,r))+4,Math.max(0,Math.min(i-e.panelTop,c))+4,r,c)}),o.hue&&(t.on(this.hueBar,"click",e=>P(i,e.y)),this.bindEvent(this.hueThumb,(e,t,o,i)=>P(e,i)))}},{name:"bindEvent",func:function(e,o,i){const n=this;t.on(e,t.eventType[0],()=>{const r=r=>{var s;r.preventDefault(),s=r,n.moveX=t.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientX:s.clientX,n.moveY=t.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientY:s.clientY,i?o(n,n.moveX,n.moveY):o(n,e,n.moveX,n.moveY)},s=()=>{t.off(document,t.eventType[1],r),t.off(document,t.eventType[2],s)};t.on(document,t.eventType[1],r),t.on(document,t.eventType[2],s)})}}];function w(e,t,o){return o?e.querySelectorAll("."+t):e.querySelector("."+t)}function k(e,o){o.config.pickerFlag=!o.config.pickerFlag,o.config.defaultColor=o.config.alpha?r(o.hsbColor):n(r(o.hsbColor)),o.render(e,o.config),_(o,o.panelWidth,o.panelHeight),v(o),t.isFunction(o.config.openPicker)&&o.config.openPicker(e,o)}function v(e){const o=t.isString(e.config.openPickerAni)&&e.config.openPickerAni.indexOf("height")>-1;return e.config.pickerFlag?l[o?"slideDown":"fadeIn"](e.picker,200):l[o?"slideUp":"fadeOut"](e.picker,200)}function y(e,t){if(!c(t))return;const o=t.indexOf("#")>-1?s(i(t)):s(t);(o.h||o.s||o.h||o.a)&&(e.hsbColor=o,_(e,e.panelWidth,e.panelHeight),T(e))}function O(e,t){x(e,t),v(t),t.config.clear(t.config.defaultColor,t)}function x(e,t){t.config.defaultColor="",t.config.pickerFlag=!t.config.pickerFlag,t.render(e,t.config)}function R(e){e.config.pickerFlag=!1,v(e),T(e);const t=e.config.alpha?r(e.hsbColor):n(r(e.hsbColor));e.config.sure(t,e)}function E(e,o,i,n,r){t.setCss(e.pickerCursor,"left",o+"px"),t.setCss(e.pickerCursor,"top",i+"px");const s=parseInt(100*(o-4)/n),a=parseInt(100*(r-(i-4))/r);e.hsbColor.s=s>100?100:s<0?0:s,e.hsbColor.b=a>100?100:a<0?0:a,T(e)}function T(e,o){const i=r(e.hsbColor);t.setCss(e.box,"background",i),e.pickerInput.value=o||e.config.alpha?i:n(i)}function S(e,t){if(t.target!==e.pickerCursor){const o=t.layerX,i=t.layerY,n=e.pickerPanel.offsetWidth,r=e.pickerPanel.offsetHeight;E(e,(o>=n-1?n:o<=0?0:o)+4,(i>=r-2?r:i<=0?0:i)+4,n,r)}}function I(e){const o=t.deepCloneObjByRecursion(e);return o.s=o.b=100,o}function M(e){e.alphaBarBg&&t.setCss(e.alphaBarBg,"background","linear-gradient(to top,"+r(I(e.hsbColor),0)+" 0%,"+r(I(e.hsbColor))+" 100%)")}function _(e,o,i){e.pickerInput.value=e.config.alpha?r(e.hsbColor):n(r(e.hsbColor));let s=0,a=parseInt(e.hsbColor.s*o/100),c=parseInt(i-e.hsbColor.b*i/100);[{el:e.pickerCursor,prop:"left",value:a+4+"px"},{el:e.pickerCursor,prop:"top",value:c+4+"px"},{el:e.pickerPanel,prop:"background",value:n(r(I(e.hsbColor)))}].forEach(e=>t.setCss(e.el,e.prop,e.value)),e.box&&(e.box.style.background=e.pickerInput.value),e.config.hue&&(s=e.hueBar.offsetHeight||180,t.setCss(e.hueThumb,"top",parseInt(e.hsbColor.h*s/360)+"px")),e.config.alpha&&(e.config.hue||(s=e.alphaBar.offsetHeight||180),t.setCss(e.alphaBarThumb,"top",s-e.hsbColor.a*s+"px"))}function P(e,o){const i=e.hueBar.offsetHeight,s=e.hueBar.getBoundingClientRect(),a=Math.max(0,Math.min(o-s.y,i));t.setCss(e.hueThumb,"top",a+"px"),e.hsbColor.h=I(e.hsbColor).h=parseInt(360*a/i),t.setCss(e.pickerPanel,"background",n(r(I(e.hsbColor)))),T(e),M(e)}function B(e,o){const i=e.alphaBar.offsetHeight,n=e.alphaBar.getBoundingClientRect(),r=Math.max(0,Math.min(o-n.y,i));t.setCss(e.alphaBarThumb,"top",r+"px");const s=(i-r<=0?0:i-r)/i;e.hsbColor.a=s>=1?1:s.toFixed(2),T(e,!0)}return C.forEach(e=>t.addMethod(m,e.name,e.func)),m}));
